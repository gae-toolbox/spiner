#!/usr/local/opt/python/bin/python2.7
import argparse
import os

DESC = """{border}
xwebapp Command Line Tool

Usage example:
    xwebapp.py create website
{border}
"""

# create the top-level parser
parser = argparse.ArgumentParser(
        description=DESC.format(border='~'*50),
        formatter_class=argparse.RawTextHelpFormatter)

subparsers = parser.add_subparsers(
        dest='command',
        title='subcommands',
        description='valid subcomands',
        help='additional help')

# create the parser for the "install" command
create = subparsers.add_parser('create', help='create help')
create.add_argument(
    'project', choices=('website', 'restapi'), help='Create new project')
create.add_argument(
    'app_id', help='application identifier')

args = parser.parse_args()

if __name__ == '__main__':
    if args.command == 'create':
        if args.project == 'website':
            os.system('wget https://github.com/xwebapp/skeleton-website/archive/master.zip -O app.zip && unzip app.zip && rm app.zip')
            os.system('mv skeleton-website-master/* .')
            os.system('rm -rf skeleton-website-master')
            os.system("sed -i '' 's/__APP_ID__/%s/g' app.yaml" % args.app_id)
            os.system('chmod -x run.py appengine_config.py')
